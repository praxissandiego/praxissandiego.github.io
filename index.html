<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Praxis San Diego</title>
    <meta name="description" content="(Re)building practices for living good lives in community.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://praxissandiego.com/">
    <meta property="og:title" content="Praxis San Diego">
    <meta property="og:description" content="(Re)building practices for living good lives in community.">
    <meta property="og:image" content="https://praxissandiego.com/images/preview.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Praxis San Diego">
    <meta name="twitter:description" content="(Re)building practices for living good lives in community.">
    <meta name="twitter:image" content="https://praxissandiego.com/images/preview.jpg">
    <link rel="icon" href="/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <canvas id="backgroundCanvas"></canvas>
    <button id="animationToggle" aria-label="Toggle background animation">⏻︎</button>

    <div class="container">
        <header>
            <h1 class="text-center">PRAXIS SAN DIEGO</h1>
        </header>

        <div class="section description">
            <h2>What Is This All About?</h2>
            <p>
                It's hard to live a good life without a broad and supportive community. It's also hard to do it without a tight-knit circle of those who you want to share your life with, both in adventures and in mundanities.
            </p>
            <p>
                We are, in short, a small, but growing group of friends living in San Diego who are working on (re)building the practices that help us to do that. Inspired by <a href="https://fractalnyc.com/">Fractal NYC</a> and <a href="https://fractalnyc.com/#:~:text=Alumni%20of%20Our%20Neighborhood%20Accelerator">other civicas around the world</a>, we are building our own intentional community here, one step at a time. Below you can find some details of what we've been up to.
            </p>
            <p>
                If this resonates with you, don't hold back and reach out to us!
            </p>
        </div>

        <div class="section">
            <div class="table-section">
                <h2>Events</h2>
                <p>
                    <strong>Monthly hang outs:</strong> soon we will start hosting monthly hang outs, jams where you can enjoy your time with others —— talk, have food, play boardgames ——  but also do something on your own —— read, work on a craft, or finish a project —— just in the company of others! Everyone is welcome to join and participate in whatever is happening or bring their own activity.
                </p>
                <p>
                    <strong>Independent research group:</strong> every Monday we hold an independent research group meeting for those who want to do self-directed research. In the meetings we work on our projects, share our progress, and give feedback to each other.
                </p>
                <p>
                    If either of these events sound fun, reach out through <a href="#apply">the form at the bottom of the page</a>!
                </p>
            </div>

            <div class="table-section">
                <h2><a href="university.html"><u>Community University</u></a></h2>
                <p>
                    We started a <a href="university.html">community university</a>: a place to teach and learn from each other for fun in a setting outside of traditional academia. Education thrives when it is enjoyable and community driven, and this is exactly what we are doing here.
                </p>
                <p>
                    Below are the classes of our second term starting in January 19th 2026:
                </p>
                <div class="table-wrapper">
                    <table id="table1" class="table-index">
                        <thead>
                            <tr>
                                <th data-column="0">Class (Click for More Info)</th>
                                <th data-column="1">Start Date</th>
                                <th data-column="2">Duration</th>
                                <th data-column="3">Interested?</th>
                            </tr>
                        </thead>
                        <tbody id="universityTableBody">
                            <!-- Data loaded dynamically -->
                        </tbody>
                    </table>
                </div>
                <br>
                <p>
                    <b><u>The registration for most classes is open until January 18 or until they get filled, but some classes have later deadlines.</u></b> If you want to learn more and register, <a href="university.html" class="view-full">click here</a> to visit our community university page!
                </p>
            </div>
        </div>

        <div class="section form-section">
            <h2 id="apply">Get in touch</h2>
            <div class="google-form-placeholder">
                <iframe data-tally-src="https://tally.so/embed/3EpPdL?alignLeft=1&hideTitle=1&transparentBackground=1" loading="lazy" width="100%" height="1447" frameborder="0" marginheight="0" marginwidth="0" title="Reach Out to Praxis San Diego"></iframe>
                <script>var d=document,w="https://tally.so/widgets/embed.js",v=function(){"undefined"!=typeof Tally?Tally.loadEmbeds():d.querySelectorAll("iframe[data-tally-src]:not([src])").forEach((function(e){e.src=e.dataset.tallySrc}))};if("undefined"!=typeof Tally)v();else if(d.querySelector('script[src="'+w+'"]')==null){var s=d.createElement("script");s.src=w,s.onload=v,s.onerror=v,d.body.appendChild(s);}</script>
            </div>
        </div>
    </div>

    <script src="js/link-conversion.js"></script>
    <script src="js/table-utils.js"></script>
    <script src="js/background-animation-smallworld.js"></script>
    <script src="js/menu.js"></script>
    <script>
        // Table initialization and data loading for index page
        let originalTableData = []; // Store original order for reset

        async function loadTableData() {
            try {
                // Load university data
                const CURRENT_TERM = 'winter2026';
                const universityResponse = await fetch(`data/terms/${CURRENT_TERM}.json`);
                const universityData = await universityResponse.json();

                // Sort by Start Date by default (parse dates for proper ordering)
                universityData.sort((a, b) => {
                    const dateA = new Date(a.start);
                    const dateB = new Date(b.start);
                    return dateA - dateB;
                });

                // Store original sorted order for reset
                originalTableData = [...universityData];

                // Populate university table
                const universityBody = document.getElementById('universityTableBody');
                if (universityBody) {
                    universityData.forEach(item => {
                        const row = document.createElement('tr');
                        // Add row ID for mobile navigation
                        row.id = item.id || item.name.toLowerCase().replace(/[^a-z0-9]+/g, '-');
                        // Handle external links properly
                        const href = item.link.startsWith('http://') || item.link.startsWith('https://')
                            ? item.link
                            : item.link;
                        row.innerHTML = `
                            <td><a href="${href}">${item.name}</a></td>
                            <td>${item.start}</td>
                            <td>${item.duration}</td>
                            <td><a href="${href}">Learn more</a></td>
                        `;
                        universityBody.appendChild(row);
                    });

                    // Create mobile class navigation dropdown
                    createMobileClassNav(universityData, 'table1');
                }

                // Initialize table functionality with three-click reset
                initTableWithReset('table1', originalTableData);

            } catch (error) {
                console.error('Error loading data:', error);
                const universityBody = document.getElementById('universityTableBody');
                if (universityBody) {
                    universityBody.innerHTML = '<tr><td colspan="4">Unable to load data. Please check data files.</td></tr>';
                }
            }
        }

        // Enhanced initTable with three-click reset to default (Start Date) order
        function initTableWithReset(tableId, originalData) {
            const table = document.getElementById(tableId);
            if (!table) {
                console.warn(`Table with ID "${tableId}" not found`);
                return;
            }

            const tbody = table.querySelector('tbody');
            const headers = table.querySelectorAll('th');

            // Initialize sort state for each header
            headers.forEach(header => {
                header.sortState = 'none';
            });

            // Note: Start Date is the default sort order, but we don't show the indicator
            // The data is already sorted by Start Date from the load function

            // Sorting functionality with three-click reset
            headers.forEach(header => {
                header.addEventListener('click', function() {
                    const column = parseInt(this.dataset.column);

                    // Cycle through states: none -> asc -> desc -> none
                    if (this.sortState === 'none' || this.sortState === undefined) {
                        this.sortState = 'asc';
                    } else if (this.sortState === 'asc') {
                        this.sortState = 'desc';
                    } else {
                        this.sortState = 'none';
                    }

                    // Remove sort classes from all headers and reset their states
                    headers.forEach(h => {
                        h.classList.remove('sort-asc', 'sort-desc');
                        if (h !== this) h.sortState = 'none';
                    });

                    // Apply appropriate class
                    if (this.sortState === 'asc') {
                        this.classList.add('sort-asc');
                    } else if (this.sortState === 'desc') {
                        this.classList.add('sort-desc');
                    }

                    const rows = Array.from(tbody.querySelectorAll('tr'));

                    if (this.sortState === 'none') {
                        // Reset to default order (sorted by Start Date, no indicator)
                        tbody.innerHTML = '';
                        originalData.forEach(item => {
                            const row = document.createElement('tr');
                            // Add row ID for mobile navigation
                            row.id = item.id || item.name.toLowerCase().replace(/[^a-z0-9]+/g, '-');
                            const href = item.link.startsWith('http://') || item.link.startsWith('https://')
                                ? item.link
                                : item.link;
                            row.innerHTML = `
                                <td><a href="${href}">${item.name}</a></td>
                                <td>${item.start}</td>
                                <td>${item.duration}</td>
                                <td><a href="${href}">Learn more</a></td>
                            `;
                            tbody.appendChild(row);
                        });
                        // Don't mark any column as sorted - this is the "default" state
                    } else {
                        // Sort rows
                        const isAsc = this.sortState === 'asc';
                        const sortedRows = rows.sort((a, b) => {
                            const aText = a.cells[column].textContent.trim();
                            const bText = b.cells[column].textContent.trim();

                            // Check if values are dates
                            const aDate = Date.parse(aText);
                            const bDate = Date.parse(bText);

                            if (!isNaN(aDate) && !isNaN(bDate)) {
                                return isAsc ? aDate - bDate : bDate - aDate;
                            }

                            // Regular string comparison
                            if (isAsc) {
                                return aText.localeCompare(bText);
                            } else {
                                return bText.localeCompare(aText);
                            }
                        });

                        // Re-append sorted rows
                        sortedRows.forEach(row => tbody.appendChild(row));
                    }
                });
            });
        }

        // Load data when page loads
        document.addEventListener('DOMContentLoaded', loadTableData);
    </script>
</body>
</html>
